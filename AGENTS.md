# 开发规范（Win11 / PowerShell）

**作者：** BaiMo_  
**原则：** First Principles、DRY、KISS、SOLID、YAGNI  
**目标：** 沟通清晰、架构可扩展、代码高质量、维护高效与安全

---

## 1. 沟通与需求确认

- **语言要求：** 所有沟通、注释与日志必须使用中文，禁止中英夹杂。
- **资源调用：** 仅允许使用我明确提供或有公开文档的接口、API、库。严禁通过反射、动态路径等手段规避校验。
- **流程完整性与积极沟通：**  
  - 所有涉及功能开发、文档输出、代码撰写、问题回复等流程，须确保一次性完整交付，不得因主观判断、token 限制或其他非业务原因，擅自中断、拆分、提前结论或延迟交付。禁止为“刷回复量”“分段输出”等非业务需求进行任何人为拆分。
  - 如遇 token 限制或需求理解不清等异常情况，须主动在回复首行或末行明确说明当前状态，并立即告知需求方，等待“继续”或进一步指示后再进行后续输出或调整，确保沟通闭环。
- **TODO 管理：** 仅在确实无法实现时，使用 `TODO` 并明确说明原因，禁止猜测或占位逻辑。

---

## 2. 设计与架构

- **先设计后开发：** 复杂逻辑或重大功能须先设计后编码。
- **单一职责与模块化：** 逻辑、事件、配置需分离，实现 SRP 和 SOLID 原则。
- **接口驱动：** 基于核心业务抽象接口和模型，优先保证可扩展性。
- **优先复用：** 先复用/扩展已有代码，避免重复造轮子，杜绝冗余。
- **KISS & YAGNI：** 只实现当前必要内容，保持代码简洁。
- **代码体量：** 单类/方法控制在 30–200 行，文件超过 500 行必须拆分并补充文档。
- **目录结构：** 大型项目需分层清晰（如 `domain/`、`service/`、`controller/` 等）。

---

## 3. 编码规范与质量

- **命名规范：** 变量、方法、类名必须清晰反映业务含义，禁止模糊命名与缩写。
- **工具使用：** 强制代码格式化和静态分析，统一风格，确保代码可读性与一致性。
- **文档注释：** 所有公开 API、类、接口必须有完整 JavaDoc 风格注释（功能、参数、返回值、异常等）；复杂逻辑需说明“为何”而非只写“做了什么”。
- **批量提交：** 合理分批提交相关变更，禁止无意义单行提交。
- **按需引入：** 仅按实际需要引入包，禁止冗余导入。
- **配置管理：** 用户可编辑内容禁止硬编码。配置文件仅在缺失时自动生成，样例配置须与实际逻辑同步。
- **扩展性设计：** 所有编码应主动考虑未来扩展需求，合理抽象接口与扩展点，避免后期结构重构。模块开发时优先使用接口、事件、回调等低耦合方式实现。
- **逻辑复用：** 编码过程中如发现具备通用性的方法或逻辑，必须提取至 `util` 工具类或公共模块，并强制复用，禁止代码重复。
- **模块分层：** 所有功能应遵循职责分层，禁止跨层调用；模块边界清晰，公共依赖统一归档，确保结构稳定、可维护。
- **异常处理：** 所有异常必须规范捕获与记录，禁止随意抛出或无提示处理，统一日志与错误信息输出格式。

---

## 4. 异步任务与性能

- **异步使用：** IO、网络、CPU 密集型操作必须异步执行，并提前评估风险。
- **线程安全：** 主线程状态变更需保证安全，不确定时必须加同步并说明原因。
- **兜底方案：** 异步逻辑必须有异常处理和降级兜底策略。

---

## 5. 安全性

- **输入校验：** 所有外部输入默认不可信，强制校验及白名单机制。
- **敏感数据：** 密码、密钥等敏感信息加密存储，严禁写入日志。
- **权限校验：** 敏感操作必须严格权限检查，遵循最小权限原则。
- **漏洞防御：** 主动防范 SQL/命令注入、路径穿越、XSS、DoS 等各类安全风险。

---

## 6. 数据与资源管理

- **持久化原则：** 先内存再持久化，数据库操作需参数化查询。
- **资源释放：** 文件、数据库连接、Socket 等用后即关，必要时使用连接池。

---

## 7. 定制化与国际化

- **可配置内容：** UI 文本、提示信息等必须配置化，严禁硬编码，便于本地化。

---

## 8. 日志与错误处理

- **日志要求：** 关键行为和异常必须有中文日志，但禁止记录敏感信息。
- **日志分级：** 合理分级日志，便于排查定位问题。

---

## 9. TODO 管理

- **标注 TODO：** 未完工、临时、待定任务须以 `// TODO` 标注，并说明具体原因。

---

## 最终原则

始终遵循以下理念：  
**First Principles（本质抽象）、DRY（不重复）、KISS（简洁）、SOLID（模块化和可维护）、YAGNI（不过度设计）**。  
**清晰、规划、安全、可维护、可扩展**是全部工作的底线。
